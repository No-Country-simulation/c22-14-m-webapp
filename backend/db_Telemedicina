-- Creación de la tabla ROLES
CREATE TABLE ROLES (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Creación de la tabla USERS
CREATE TABLE USERS (
    id SERIAL PRIMARY KEY,
    firstName VARCHAR(255) NOT NULL,
    lastName VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role_id INT REFERENCES ROLES(id) ON DELETE SET NULL,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Creación de la tabla DOCTORS
CREATE TABLE DOCTORS (
    id INT PRIMARY KEY,
    specialty VARCHAR(255) NOT NULL,
    license_number VARCHAR(255) UNIQUE NOT NULL,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id) REFERENCES USERS(id) ON DELETE CASCADE
);

-- Creación de la tabla PATIENTS
CREATE TABLE PATIENTS (
    id INT PRIMARY KEY,
    address VARCHAR(255),
    dni VARCHAR(20) UNIQUE NOT NULL,
    birthdate DATE,
    phoneNumber VARCHAR(20),
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id) REFERENCES USERS(id) ON DELETE CASCADE
);

-- Creación de la tabla ADMINS
CREATE TABLE ADMINS (
    id INT PRIMARY KEY,
    department VARCHAR(255) NOT NULL,
    access_level VARCHAR(50) NOT NULL,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id) REFERENCES USERS(id) ON DELETE CASCADE
);

-- Creación de la tabla APPOINTMENTS
CREATE TABLE APPOINTMENTS (
    id SERIAL PRIMARY KEY,
    patient_name VARCHAR(255) NOT NULL,
    patient_phone VARCHAR(10) NOT NULL,
    patient_email VARCHAR(255) NOT NULL,
    doctor_id INT REFERENCES DOCTORS(id) ON DELETE CASCADE,
    specialty VARCHAR(255) NOT NULL, 
    date TIMESTAMP NOT NULL,
    hours VARCHAR(255) NOT NULL,
    status VARCHAR(50),
    description TEXT,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Creación de la tabla MEDICAL_RECORDS
CREATE TABLE MEDICAL_RECORDS (
    id SERIAL PRIMARY KEY,
    appointment_id INT REFERENCES APPOINTMENTS(id) ON DELETE CASCADE,
    consultation TEXT,
    diagnosis TEXT,
    treatment TEXT,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
